<!-- HTML header for doxygen 1.8.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Typhoon: TyphoonFactoryProvider Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="typhoon-docs.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea" >
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="http://www.typhoonframework.org"><img alt="Logo" src="typhoon-logo.png"/></a></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('interface_typhoon_factory_provider.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Properties</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Class Methods</a> &#124;
<a href="class_typhoon_factory_provider-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">TyphoonFactoryProvider Class Reference<div class="ingroups"><a class="el" href="group___factory.html">Factory</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Provides a factory that combines the convenience method arguments with the assembly-supplied dependencies to construct objects.  
 <a href="interface_typhoon_factory_provider.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for TyphoonFactoryProvider:</div>
<div class="dyncontent">
<div class="center"><img src="interface_typhoon_factory_provider__inherit__graph.png" border="0" usemap="#_typhoon_factory_provider_inherit__map" alt="Inheritance graph"/></div>
<map name="_typhoon_factory_provider_inherit__map" id="_typhoon_factory_provider_inherit__map">
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Class Methods</h2></td></tr>
<tr class="memitem:a85f585a67e0a3bd309d44ad580a7928d"><td class="memItemLeft" align="right" valign="top">(<a class="el" href="interface_typhoon_definition.html">TyphoonDefinition</a> *)&#160;</td><td class="memItemRight" valign="bottom">+ <a class="el" href="interface_typhoon_factory_provider.html#a85f585a67e0a3bd309d44ad580a7928d">withProtocol:dependencies:factory:</a></td></tr>
<tr class="memdesc:a85f585a67e0a3bd309d44ad580a7928d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a factory definition for a given protocol, dependencies and factory block.  <a href="#a85f585a67e0a3bd309d44ad580a7928d">More...</a><br/></td></tr>
<tr class="separator:a85f585a67e0a3bd309d44ad580a7928d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e5e8ffa843c993940e3cccb1f5660d3"><td class="memItemLeft" align="right" valign="top">(<a class="el" href="interface_typhoon_definition.html">TyphoonDefinition</a> *)&#160;</td><td class="memItemRight" valign="bottom">+ <a class="el" href="interface_typhoon_factory_provider.html#a5e5e8ffa843c993940e3cccb1f5660d3">withProtocol:dependencies:returns:</a></td></tr>
<tr class="memdesc:a5e5e8ffa843c993940e3cccb1f5660d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a factory definition for a given protocol, dependencies, and return type.  <a href="#a5e5e8ffa843c993940e3cccb1f5660d3">More...</a><br/></td></tr>
<tr class="separator:a5e5e8ffa843c993940e3cccb1f5660d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ceab7ef446241a2a0d0aa5db842d5a1"><td class="memItemLeft" align="right" valign="top">(<a class="el" href="interface_typhoon_definition.html">TyphoonDefinition</a> *)&#160;</td><td class="memItemRight" valign="bottom">+ <a class="el" href="interface_typhoon_factory_provider.html#a6ceab7ef446241a2a0d0aa5db842d5a1">withProtocol:dependencies:factories:</a></td></tr>
<tr class="memdesc:a6ceab7ef446241a2a0d0aa5db842d5a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a factor definition for a given protocol, dependencies and a list of factory methods.  <a href="#a6ceab7ef446241a2a0d0aa5db842d5a1">More...</a><br/></td></tr>
<tr class="separator:a6ceab7ef446241a2a0d0aa5db842d5a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Provides a factory that combines the convenience method arguments with the assembly-supplied dependencies to construct objects. </p>
<p>To create a factory you must define a protocol for the factory, wire its dependencies (defined as readonly properties), and, sometimes, provide implementation blocks or initializer descriptions for the body of the class methods. Most of the simplest cases should be covered with no glue code, and the rest of them, with a couple of lines.</p>
<h2>Example</h2>
<p>Imagine you have defined this Payment class with two dependencies that should be injected, and two parameters that must be provided at runtime.</p>
<div class="fragment"><div class="line"><span class="keyword">@interface </span>Payment : NSObject</div>
<div class="line"></div>
<div class="line">- (instancetype)initWithCreditService:(<span class="keywordtype">id</span>&lt;CreditService&gt;)creditService authService:(<span class="keywordtype">id</span>&lt;AuthService&gt;)authService startDate:(NSDate *)date</div>
<div class="line">   amount:(NSUInteger)amount;</div>
<div class="line"></div>
<div class="line"><span class="keyword">@end</span></div>
</div><!-- fragment --><p>You also define a protocol for the factory of the Payment objects. The factory must declare the dependencies as readonly properties, and the factory methods should be the only ones existing.</p>
<div class="fragment"><div class="line"><span class="keyword">@protocol </span>PaymentFactory &lt;NSObject&gt;</div>
<div class="line"></div>
<div class="line"><span class="keyword">@property</span> (nonatomic, strong, readonly) id&lt;CreditService&gt; creditService;</div>
<div class="line"><span class="keyword">@property</span> (nonatomic, strong, readonly) id&lt;AuthService&gt; authService;</div>
<div class="line"></div>
<div class="line">+ (Payment *)paymentWithStartDate:(NSDate *)startDate amount:(NSUInteger)amount;</div>
<div class="line"></div>
<div class="line"><span class="keyword">@end</span></div>
</div><!-- fragment --><p>(It is very important that your properties, which will normally be the dependencies, are readonly. Do not worry, Typhoon will be able to inject their values just fine).</p>
<p>Then, in your assembly file, you define the PaymentFactory component using the <a class="el" href="interface_typhoon_factory_provider.html" title="Provides a factory that combines the convenience method arguments with the assembly-supplied dependen...">TyphoonFactoryProvider</a> as the following code:</p>
<div class="fragment"><div class="line">- (id)paymentFactory {</div>
<div class="line">  <span class="keywordflow">return</span> [<a class="code" href="interface_typhoon_factory_provider.html">TyphoonFactoryProvider</a> withProtocol:<span class="keyword">@protocol</span>(PaymentFactory) dependencies:^(<a class="code" href="interface_typhoon_definition.html">TyphoonDefinition</a> *definition)</div>
<div class="line">  {</div>
<div class="line">    [definition injectProperty:<span class="keyword">@selector</span>(creditService)];</div>
<div class="line">    [definition injectProperty:<span class="keyword">@selector</span>(authService)];</div>
<div class="line">  } returns:[Payment <span class="keyword">class</span>]];</div>
<div class="line">}</div>
</div><!-- fragment --><p>The factory provider will create a new class during runtime to implement the protocol, and create the implementation of the protocol method looking for a good init method in the return type.</p>
<p>In the dependencies block you can use any <code>injectProperty:</code> method that you will use for your normal definitions. It is a standard TyphoonDefinitionBlock that get passed directly to the <a class="el" href="interface_typhoon_definition.html">TyphoonDefinition</a> constructor used internally.</p>
<p>Sometimes you might need to customize which init method gets used in the factory method, since the heuristic might not work for your classes, or you cannot modify the return type method names. In those cases, you can always provide your own implementation, and make the call to the init method yourself:</p>
<div class="fragment"><div class="line">- (id)paymentFactory</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">return</span> [<a class="code" href="interface_typhoon_factory_provider.html">TyphoonFactoryProvider</a> withProtocol:<span class="keyword">@protocol</span>(PaymentFactory) dependencies:^(<a class="code" href="interface_typhoon_definition.html">TyphoonDefinition</a> *definition)</div>
<div class="line">  {</div>
<div class="line">    [definition injectProperty:<span class="keyword">@selector</span>(creditService)];</div>
<div class="line">    [definition injectProperty:<span class="keyword">@selector</span>(authService)];</div>
<div class="line">  } factories:^(<a class="code" href="interface_typhoon_assisted_factory_definition.html">TyphoonAssistedFactoryDefinition</a> *definition) {</div>
<div class="line">    [definition factoryMethod:<span class="keyword">@selector</span>(paymentWithStartDate:amount:) body:^<span class="keywordtype">id</span> (id&lt;PaymentFactory&gt; factory, NSDate *startDate, NSUInteger amount) {</div>
<div class="line">      <span class="keywordflow">return</span> [[Payment alloc] initWithCreditService:factory.creditService authService:factory.authService startDate:startDate amount:amount];</div>
<div class="line">    }];</div>
<div class="line">  }];</div>
<div class="line">}</div>
</div><!-- fragment --><p>For the factories block you must provide one body block for each class method of your factory protocol. The block used as the body receives the factory itself as the first argument, so you can use the factory properties, and then the rest of the class method arguments in the second and following positions.</p>
<p>You can use <code>withProtocol:dependencies:factories:</code> method also when your protocol has several factory methods, providing one body for each of them.</p>
<p>In the case of the protocol having only one factory method you can use a shorter version of the method. For example the equivalent shorter version for the above definition will be the following one:</p>
<div class="fragment"><div class="line">- (id)paymentFactory</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">return</span> [<a class="code" href="interface_typhoon_factory_provider.html">TyphoonFactoryProvider</a> withProtocol:<span class="keyword">@protocol</span>(PaymentFactory) dependencies:^(<a class="code" href="interface_typhoon_definition.html">TyphoonDefinition</a> *definition)</div>
<div class="line">  {</div>
<div class="line">    [definition injectProperty:<span class="keyword">@selector</span>(creditService)];</div>
<div class="line">    [definition injectProperty:<span class="keyword">@selector</span>(authService)];</div>
<div class="line">  } factory^id (id&lt;PaymentFactory&gt; factory, NSDate *startDate, NSUInteger amount)</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">return</span> [[Payment alloc] initWithCreditService:factory.creditService authService:factory.authService startDate:startDate amount:amount];</div>
<div class="line">  }];</div>
<div class="line">}</div>
</div><!-- fragment --><p>There is an alternative way to define the factory methods, but since it involves writing a lot more code than the blocks used above, it is not recommended. For the example above the code will be the following:</p>
<div class="fragment"><div class="line">- (id)paymentFactory</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">return</span> [<a class="code" href="interface_typhoon_factory_provider.html">TyphoonFactoryProvider</a> withProtocol:<span class="keyword">@protocol</span>(PaymentFactory) dependencies:^(<a class="code" href="interface_typhoon_definition.html">TyphoonDefinition</a> *definition)</div>
<div class="line">  {</div>
<div class="line">    [definition injectProperty:<span class="keyword">@selector</span>(creditService)];</div>
<div class="line">    [definition injectProperty:<span class="keyword">@selector</span>(authService)];</div>
<div class="line">  } factories:^(<a class="code" href="interface_typhoon_assisted_factory_definition.html">TyphoonAssistedFactoryDefinition</a> *definition)</div>
<div class="line">  {</div>
<div class="line">    [definition factoryMethod:<span class="keyword">@selector</span>(paymentWithStartDate:amount:) returns:[Payment <span class="keyword">class</span>]</div>
<div class="line">            initialization:^(<a class="code" href="interface_typhoon_assisted_factory_method_initializer.html">TyphoonAssistedFactoryMethodInitializer</a> *initializer) {</div>
<div class="line">        [initializer setSelector:<span class="keyword">@selector</span>(initWithCreditService:authService:startDate:amount:)];</div>
<div class="line">        [initializer injectWithProperty:<span class="keyword">@selector</span>(creditService)];</div>
<div class="line">        [initializer injectWithProperty:<span class="keyword">@selector</span>(authService)];</div>
<div class="line">        [initializer injectWithArgumentNamed:<span class="stringliteral">@&quot;startDate&quot;</span>];</div>
<div class="line">        [initializer injectWithArgumentNamed:<span class="stringliteral">@&quot;amount&quot;</span>];</div>
<div class="line">    }];</div>
<div class="line">  }];</div>
<div class="line">}</div>
</div><!-- fragment --><p>You can also use <code>injectWithArgumentAtIndex:</code> if you prefer to refer to the factory method argument position.</p>
<p>Known limitation: You can only create one factory for a given protocol. </p>
</div><h2 class="groupheader">Method Documentation</h2>
<a class="anchor" id="a6ceab7ef446241a2a0d0aa5db842d5a1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">+ (<a class="el" href="interface_typhoon_definition.html">TyphoonDefinition</a>*) withProtocol: </td>
          <td></td>
          <td class="paramtype">(Protocol *)&#160;</td>
          <td class="paramname"><em>protocol</em></td>
        </tr>
        <tr>
          <td class="paramkey">dependencies:</td>
          <td></td>
          <td class="paramtype">(TyphoonDefinitionBlock)&#160;</td>
          <td class="paramname"><em>dependenciesBlock</em></td>
        </tr>
        <tr>
          <td class="paramkey">factories:</td>
          <td></td>
          <td class="paramtype">(TyphoonAssistedFactoryDefinitionBlock)&#160;</td>
          <td class="paramname"><em>definitionBlock</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a factor definition for a given protocol, dependencies and a list of factory methods. </p>
<p>The protocol is supposed to have the same number of class methods, and with the same selectors as defined in the factories block, otherwise this method will fail during runtime. </p>

</div>
</div>
<a class="anchor" id="a85f585a67e0a3bd309d44ad580a7928d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">+ (<a class="el" href="interface_typhoon_definition.html">TyphoonDefinition</a>*) withProtocol: </td>
          <td></td>
          <td class="paramtype">(Protocol *)&#160;</td>
          <td class="paramname"><em>protocol</em></td>
        </tr>
        <tr>
          <td class="paramkey">dependencies:</td>
          <td></td>
          <td class="paramtype">(TyphoonDefinitionBlock)&#160;</td>
          <td class="paramname"><em>dependenciesBlock</em></td>
        </tr>
        <tr>
          <td class="paramkey">factory:</td>
          <td></td>
          <td class="paramtype">(id)&#160;</td>
          <td class="paramname"><em>factoryBlock</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a factory definition for a given protocol, dependencies and factory block. </p>
<p>The protocol is supposed to only have one factory method, otherwise this method will fail during runtime. </p>

</div>
</div>
<a class="anchor" id="a5e5e8ffa843c993940e3cccb1f5660d3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">+ (<a class="el" href="interface_typhoon_definition.html">TyphoonDefinition</a>*) withProtocol: </td>
          <td></td>
          <td class="paramtype">(Protocol *)&#160;</td>
          <td class="paramname"><em>protocol</em></td>
        </tr>
        <tr>
          <td class="paramkey">dependencies:</td>
          <td></td>
          <td class="paramtype">(TyphoonDefinitionBlock)&#160;</td>
          <td class="paramname"><em>dependenciesBlock</em></td>
        </tr>
        <tr>
          <td class="paramkey">returns:</td>
          <td></td>
          <td class="paramtype">(Class)&#160;</td>
          <td class="paramname"><em>returnType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a factory definition for a given protocol, dependencies, and return type. </p>
<p>The protocol is supposed to only have one factory method, otherwise this method will fail during runtime.</p>
<p>The factory method will invoke one of the initializer methods of the returnType. To determine which initializer method will be used, the atoms of the factory method and the init method will be matched, filling up missing parameters with the properties present in the protocol. Ties will be resolved choosing the init method with most factory method argument used, and the arbitrarily. If no valid init method is found, the invocation will fail during runtime.</p>
<p>For this method to work the names of the factory methods and the init method should follow some common rules:</p>
<ul>
<li>The init method name should start with <code>initWith</code>.</li>
<li>The factory method name should have <code>With</code> between the return type and the argument "names".</li>
<li>All argument "names" are transformed to be "camelCase" (first letter will always be lowercase).</li>
<li>Property names should be "camelCase".</li>
<li>No "and" between argument "names".</li>
</ul>
<p>Initializers and factory methods like the following follow the rules:</p>
<ul>
<li>initWithName:, initWithName:age:gender:, initWithDate:amount:</li>
<li>personWithName:, personWithName:age:gender:, paymentWithDate:amount:</li>
</ul>
<p>While names like the following will not work:</p>
<ul>
<li>initFromFile:, initWithX:andY:</li>
<li>personNamed:age:gender:</li>
</ul>
<p>If your init method or your factory method could not follow the rules (or you don't want them to follow the rules) you should use one of the other methods and provide the implementation block yourself. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.5-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="interface_typhoon_factory_provider.html">TyphoonFactoryProvider</a></li>
    <li class="footer">Generated on Mon Dec 9 2013 20:20:23 for Typhoon by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
