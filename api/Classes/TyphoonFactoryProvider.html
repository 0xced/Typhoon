<!DOCTYPE HTML>
<html>
	<head>
		<meta http-equiv="Content-Type" content="html/html; charset=utf-8" />
		<title>TyphoonFactoryProvider Class Reference</title>
		<meta id="xcode-display" name="xcode-display" content="render"/>
		<meta name="viewport" content="width=550" />
		<link rel="stylesheet" type="text/css" href="../css/styles.css" media="all" />
		<link rel="stylesheet" type="text/css" media="print" href="../css/stylesPrint.css" />
		<meta name="generator" content="appledoc 2.0.5 (build 789)" />
	</head>
	<body>
		<header id="top_header">
			<div id="library" class="hideInXcode">
				<h1><a id="libraryTitle" href="../index.html">Typhoon </a></h1>
				<a id="developerHome" href="../index.html">typhoonframework.org</a>
			</div>
			
			<div id="title" role="banner">
				<h1 class="hideInXcode">TyphoonFactoryProvider Class Reference</h1>
			</div>
			<ul id="headerButtons" role="toolbar">
				<li id="toc_button">
					<button aria-label="Show Table of Contents" role="checkbox" class="open" id="table_of_contents"><span class="disclosure"></span>Table of Contents</button>
				</li>
				<li id="jumpto_button" role="navigation">
					<select id="jumpTo">
	<option value="top">Jump To&#133;</option>
	
	<option value="overview">Overview</option>
	
	
	
	
	<option value="tasks">Tasks</option>
	
	
	
	
	
	
	
	<option value="class_methods">Class Methods</option>
	
	<option value="//api/name/withProtocol:dependencies:factories:">&nbsp;&nbsp;&nbsp;&nbsp;+ withProtocol:dependencies:factories:</option>
	
	<option value="//api/name/withProtocol:dependencies:factory:">&nbsp;&nbsp;&nbsp;&nbsp;+ withProtocol:dependencies:factory:</option>
	
	
	
	
	
</select>
				</li>
			</ul>
		</header>
		<nav id="tocContainer" class="isShowingTOC">
			<ul id="toc" role="tree">
				
<li role="treeitem"><span class="nodisclosure"></span><span class="sectionName"><a href="#overview">Overview</a></span></li>




<li role="treeitem" id="task_treeitem"><span class="nodisclosure"></span><span class="sectionName"><a href="#tasks">Tasks</a></span><ul>
	
</ul></li>







<li role="treeitem" class="children"><span class="disclosure"></span><span class="sectionName"><a href="#class_methods">Class Methods</a></span><ul>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#//api/name/withProtocol:dependencies:factories:">withProtocol:dependencies:factories:</a></span></li>
	
	<li><span class="nodisclosure"></span><span class="sectionName"><a href="#//api/name/withProtocol:dependencies:factory:">withProtocol:dependencies:factory:</a></span></li>
	
</ul></li>




			</ul>
		</nav>
		<article>
			<div id="contents" class="isShowingTOC" role="main">
				<a title="TyphoonFactoryProvider Class Reference" name="top"></a>
				<div class="main-navigation navigation-top">
					<ul>
	<li><a href="../index.html">Index</a></li>
	<li><a href="../hierarchy.html">Hierarchy</a></li>
</ul>
				</div>
				<div id="header">
					<div class="section-header">
						<h1 class="title title-header">TyphoonFactoryProvider Class Reference</h1>
					</div>		
				</div>
				<div id="container">	
					
					<div class="section section-specification"><table cellspacing="0"><tbody>
						<tr>
	<td class="specification-title">Inherits from</td>
	<td class="specification-value">NSObject</td>
</tr><tr>
	<td class="specification-title">Declared in</td>
	<td class="specification-value">TyphoonFactoryProvider.h</td>
</tr>
						</tbody></table></div>
					
					
					
					
					<div class="section section-overview">
						<a title="Overview" name="overview"></a>
						<h2 class="subtitle subtitle-overview">Overview</h2>
						<p>Provides a factory that combines the convenience method arguments with the
assembly-supplied dependencies to construct objects.</p>

<p>To create a factory you must define a protocol for the factory, wire its
dependencies (defined as readonly properties), and provide implementation
blocks for the body of the class methods. It is not as automatic as we will
like, but at least it avoids a lot of tedius and repetitive boilerplate.</p>

<h1>Example</h1>

<p>Imagine you have defined this Payment class with two dependencies that should
be injected, and two parameters that must be provided at runtime.</p>

<pre><code>@interface Payment : NSObject

- (instancetype)initWithCreditService:(id&lt;CreditService&gt;)creditService
                          authService:(id&lt;AuthService&gt;)authService
                            startDate:(NSDate *)date
                                amout:(NSUInteger)amount;

@end
</code></pre>

<p>You also define a protocol for the factory of the Payment objects. The factory
must declare the dependencies as readonly properties, and the factory methods
should be the only ones existing.</p>

<pre><code>@protocol PaymentFactory &lt;NSObject&gt;

@property (nonatomic, strong, readonly) id&lt;CreditService&gt; creditService;
@property (nonatomic, strong, readonly) id&lt;AuthService&gt; authService;

+ (Payment *)paymentWithStartDate:(NSDate *)startDate
                           amount:(NSUInteger)amount;

@end
</code></pre>

<p>Then, in your assembly file, you define the PaymentFactory component using the
TyphoonFactoryProvider as the following code:</p>

<pre><code>- (id)paymentFactory {
  return [TyphoonFactoryProvider withProtocol:@protocol(PaymentFactory) dependencies:^(TyphoonDefinition *definition) {
    [definition injectProperty:@selector(creditService)];
    [definition injectProperty:@selector(authService)];
  } factories:^(TyphoonAssistedFactoryDefinition *definition) {
    [definition factoryMethod:@selector(paymentWithStartDate:amount:) body:^id (id&lt;PaymentFactory&gt; factory, NSDate *startDate, NSUInteger amount) {
      return [[Payment alloc] initWithCreditService:factory.creditService authService:factory.authService startDate:startDate amount:amount];
    }];
  }];
}
</code></pre>

<p>In the dependencies block you can use any <code>injectProperty:</code> method that you
will use for your normal definitions. It is a standard TyphoonDefinitionBlock
that get passed directly to the <a href="../Classes/TyphoonDefinition.html">TyphoonDefinition</a> constructor used internally.</p>

<p>For the factories block you must provide one body block for each class method
of your factory protocol. The block used as the body receives the factory
itself as the first argument, so you can use the factory properties, and then
the rest of the class method arguments in the second and following positions.</p>

<p>In the case of the protocol having only one factory method you can use a
shorter version of the method. For example the equivalent shorter version for
the above definition will be the following one:</p>

<pre><code>- (id)paymentFactory {
  return [TyphoonFactoryProvider withProtocol:@protocol(PaymentFactory) dependencies:^(TyphoonDefinition *definition) {
    [definition injectProperty:@selector(creditService)];
    [definition injectProperty:@selector(authService)];
  } factory^id (id&lt;PaymentFactory&gt; factory, NSDate *startDate, NSUInteger amount) {
    return [[Payment alloc] initWithCreditService:factory.creditService authService:factory.authService startDate:startDate amount:amount];
  }];
}
</code></pre>

<p>Know limitation: You can only create one factory for a given protocol.</p>
					</div>
					
					
					
					
					
					<div class="section section-tasks">
						<a title="Tasks" name="tasks"></a>
						<h2 class="subtitle subtitle-tasks">Tasks</h2>
						
						
						
						

						<ul class="task-list">
							<li>
	<span class="tooltip">
		<code><a href="#//api/name/withProtocol:dependencies:factory:">+&nbsp;withProtocol:dependencies:factory:</a></code>
		<span class="tooltip"><p>Creates a factory definition for a given protocol, dependencies and factory
block. The protocol is supposed to only have one class method, otherwise this
method will fail during runtime.</p></span>
	</span>
	
	
</li><li>
	<span class="tooltip">
		<code><a href="#//api/name/withProtocol:dependencies:factories:">+&nbsp;withProtocol:dependencies:factories:</a></code>
		<span class="tooltip"><p>Creates a factor definition for a given protocol, dependencies and a list of
factory methods. The protocol is supposed to have the same number of class
methods, and with the same selectors as defined in the factories block,
otherwise this method will fail during runtime.</p></span>
	</span>
	
	
</li>
						</ul>
						
					</div>
					
					
					
					
					
					
					
					<div class="section section-methods">
						<a title="Class Methods" name="class_methods"></a>
						<h2 class="subtitle subtitle-methods">Class Methods</h2>
						
						<div class="section-method">
	<a name="//api/name/withProtocol:dependencies:factories:" title="withProtocol:dependencies:factories:"></a>
	<h3 class="subsubtitle method-title">withProtocol:dependencies:factories:</h3>
	
	
	
	<div class="method-subsection brief-description">
		<p>Creates a factor definition for a given protocol, dependencies and a list of
factory methods. The protocol is supposed to have the same number of class
methods, and with the same selectors as defined in the factories block,
otherwise this method will fail during runtime.</p>
	</div>		
	
    

	<div class="method-subsection method-declaration"><code>+ (TyphoonDefinition *)withProtocol:(Protocol *)<em>protocol</em> dependencies:(TyphoonDefinitionBlock)<em>dependenciesBlock</em> factories:(TyphoonAssistedFactoryDefinitionBlock)<em>definitionBlock</em></code></div>

    
	
	
	
	
	
	
	
	<div class="method-subsection discussion-section">
		<h4 class="method-subtitle">Discussion</h4>
		<p>Creates a factor definition for a given protocol, dependencies and a list of
factory methods. The protocol is supposed to have the same number of class
methods, and with the same selectors as defined in the factories block,
otherwise this method will fail during runtime.</p>
	</div>
	
	
	
	
	
	
	
	<div class="method-subsection declared-in-section">
		<h4 class="method-subtitle">Declared In</h4>
		<code class="declared-in-ref">TyphoonFactoryProvider.h</code><br />
	</div>				
	
	
</div>
						
						<div class="section-method">
	<a name="//api/name/withProtocol:dependencies:factory:" title="withProtocol:dependencies:factory:"></a>
	<h3 class="subsubtitle method-title">withProtocol:dependencies:factory:</h3>
	
	
	
	<div class="method-subsection brief-description">
		<p>Creates a factory definition for a given protocol, dependencies and factory
block. The protocol is supposed to only have one class method, otherwise this
method will fail during runtime.</p>
	</div>		
	
    

	<div class="method-subsection method-declaration"><code>+ (TyphoonDefinition *)withProtocol:(Protocol *)<em>protocol</em> dependencies:(TyphoonDefinitionBlock)<em>dependenciesBlock</em> factory:(id)<em>factoryBlock</em></code></div>

    
	
	
	
	
	
	
	
	<div class="method-subsection discussion-section">
		<h4 class="method-subtitle">Discussion</h4>
		<p>Creates a factory definition for a given protocol, dependencies and factory
block. The protocol is supposed to only have one class method, otherwise this
method will fail during runtime.</p>
	</div>
	
	
	
	
	
	
	
	<div class="method-subsection declared-in-section">
		<h4 class="method-subtitle">Declared In</h4>
		<code class="declared-in-ref">TyphoonFactoryProvider.h</code><br />
	</div>				
	
	
</div>
						
					</div>
					
					
					
					
				</div>
				<div class="main-navigation navigation-bottom">
					<ul>
	<li><a href="../index.html">Index</a></li>
	<li><a href="../hierarchy.html">Hierarchy</a></li>
</ul>
				</div>
				<div id="footer">
					<hr />
					<div class="footer-copyright">
						<p><span class="copyright">&copy; 2013 typhoonframework.org. All rights reserved. (Last updated: 2013-11-23)</span><br />
						
						<span class="generator">Generated by <a href="http://appledoc.gentlebytes.com">appledoc 2.0.5 (build 789)</a>.</span></p>
						
					</div>
				</div>
			</div>
		</article>
		<script type="text/javascript">
			function jumpToChange()
			{
				window.location.hash = this.options[this.selectedIndex].value;
			}
			
			function toggleTOC()
			{
				var contents = document.getElementById('contents');
				var tocContainer = document.getElementById('tocContainer');
				
				if (this.getAttribute('class') == 'open')
				{
					this.setAttribute('class', '');
					contents.setAttribute('class', '');
					tocContainer.setAttribute('class', '');
					
					window.name = "hideTOC";
				}
				else
				{
					this.setAttribute('class', 'open');
					contents.setAttribute('class', 'isShowingTOC');
					tocContainer.setAttribute('class', 'isShowingTOC');
					
					window.name = "";
				}
				return false;
			}
			
			function toggleTOCEntryChildren(e)
			{
				e.stopPropagation();
				var currentClass = this.getAttribute('class');
				if (currentClass == 'children') {
					this.setAttribute('class', 'children open');
				}
				else if (currentClass == 'children open') {
					this.setAttribute('class', 'children');
				}
				return false;
			}
			
			function tocEntryClick(e)
			{
				e.stopPropagation();
				return true;
			}
			
			function init()
			{
				var selectElement = document.getElementById('jumpTo');
				selectElement.addEventListener('change', jumpToChange, false);
				
				var tocButton = document.getElementById('table_of_contents');
				tocButton.addEventListener('click', toggleTOC, false);
				
				var taskTreeItem = document.getElementById('task_treeitem');
				if (taskTreeItem.getElementsByTagName('li').length > 0)
				{
					taskTreeItem.setAttribute('class', 'children');
					taskTreeItem.firstChild.setAttribute('class', 'disclosure');
				}
				
				var tocList = document.getElementById('toc');
				
				var tocEntries = tocList.getElementsByTagName('li');
				for (var i = 0; i < tocEntries.length; i++) {
					tocEntries[i].addEventListener('click', toggleTOCEntryChildren, false);
				}
				
				var tocLinks = tocList.getElementsByTagName('a');
				for (var i = 0; i < tocLinks.length; i++) {
					tocLinks[i].addEventListener('click', tocEntryClick, false);
				}
				
				if (window.name == "hideTOC") {
					toggleTOC.call(tocButton);
				}
			}
			
			window.onload = init;
			
			// If showing in Xcode, hide the TOC and Header
			if (navigator.userAgent.match(/xcode/i)) {
				document.getElementById("contents").className = "hideInXcode"
				document.getElementById("tocContainer").className = "hideInXcode"
				document.getElementById("top_header").className = "hideInXcode"
			}
			
		</script>
	</body>
</html>